{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nexports.getRequestMotionPermission = getRequestMotionPermission;\nvar _Permissions = require(\"./Permissions.types\");\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == typeof value && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var methodName = context.method, method = delegate.iterator[methodName]; if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel; var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) keys.push(key); return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nfunction _getUserMedia(constraints) {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n  var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || function () {\n    var error = new Error('Permission unimplemented');\n    error.code = 0;\n    error.name = 'NotAllowedError';\n    throw error;\n  };\n  return new Promise(function (resolve, reject) {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\nfunction askForMediaPermissionAsync(options) {\n  var message;\n  return _regeneratorRuntime().async(function askForMediaPermissionAsync$(_context) {\n    while (1) switch (_context.prev = _context.next) {\n      case 0:\n        _context.prev = 0;\n        _context.next = 3;\n        return _regeneratorRuntime().awrap(_getUserMedia(options));\n      case 3:\n        return _context.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.GRANTED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: true\n        });\n      case 6:\n        _context.prev = 6;\n        _context.t0 = _context[\"catch\"](0);\n        message = _context.t0.message;\n        if (!(message === 'Permission dismissed')) {\n          _context.next = 13;\n          break;\n        }\n        return _context.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.UNDETERMINED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        });\n      case 13:\n        return _context.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.DENIED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        });\n      case 14:\n      case \"end\":\n        return _context.stop();\n    }\n  }, null, null, [[0, 6]], Promise);\n}\nfunction askForMicrophonePermissionAsync() {\n  return _regeneratorRuntime().async(function askForMicrophonePermissionAsync$(_context2) {\n    while (1) switch (_context2.prev = _context2.next) {\n      case 0:\n        _context2.next = 2;\n        return _regeneratorRuntime().awrap(askForMediaPermissionAsync({\n          audio: true\n        }));\n      case 2:\n        return _context2.abrupt(\"return\", _context2.sent);\n      case 3:\n      case \"end\":\n        return _context2.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction askForCameraPermissionAsync() {\n  return _regeneratorRuntime().async(function askForCameraPermissionAsync$(_context3) {\n    while (1) switch (_context3.prev = _context3.next) {\n      case 0:\n        _context3.next = 2;\n        return _regeneratorRuntime().awrap(askForMediaPermissionAsync({\n          video: true\n        }));\n      case 2:\n        return _context3.abrupt(\"return\", _context3.sent);\n      case 3:\n      case \"end\":\n        return _context3.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction askForLocationPermissionAsync() {\n  return _regeneratorRuntime().async(function askForLocationPermissionAsync$(_context4) {\n    while (1) switch (_context4.prev = _context4.next) {\n      case 0:\n        return _context4.abrupt(\"return\", new Promise(function (resolve) {\n          navigator.geolocation.getCurrentPosition(function () {\n            return resolve({\n              status: _Permissions.PermissionStatus.GRANTED,\n              expires: 'never',\n              canAskAgain: true,\n              granted: true\n            });\n          }, function (_ref2) {\n            var code = _ref2.code;\n            if (code === 1) {\n              resolve({\n                status: _Permissions.PermissionStatus.DENIED,\n                expires: 'never',\n                canAskAgain: true,\n                granted: false\n              });\n            } else {\n              resolve({\n                status: _Permissions.PermissionStatus.UNDETERMINED,\n                expires: 'never',\n                canAskAgain: true,\n                granted: false\n              });\n            }\n          });\n        }));\n      case 1:\n      case \"end\":\n        return _context4.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction getPermissionWithQueryAsync(name) {\n  var _await$navigator$perm, state;\n  return _regeneratorRuntime().async(function getPermissionWithQueryAsync$(_context5) {\n    while (1) switch (_context5.prev = _context5.next) {\n      case 0:\n        if (!(!navigator || !navigator.permissions || !navigator.permissions.query)) {\n          _context5.next = 2;\n          break;\n        }\n        return _context5.abrupt(\"return\", null);\n      case 2:\n        _context5.next = 4;\n        return _regeneratorRuntime().awrap(navigator.permissions.query({\n          name: name\n        }));\n      case 4:\n        _await$navigator$perm = _context5.sent;\n        state = _await$navigator$perm.state;\n        if (!(state === 'prompt')) {\n          _context5.next = 10;\n          break;\n        }\n        return _context5.abrupt(\"return\", _Permissions.PermissionStatus.UNDETERMINED);\n      case 10:\n        if (!(state === 'granted')) {\n          _context5.next = 14;\n          break;\n        }\n        return _context5.abrupt(\"return\", _Permissions.PermissionStatus.GRANTED);\n      case 14:\n        if (!(state === 'denied')) {\n          _context5.next = 16;\n          break;\n        }\n        return _context5.abrupt(\"return\", _Permissions.PermissionStatus.DENIED);\n      case 16:\n        return _context5.abrupt(\"return\", null);\n      case 17:\n      case \"end\":\n        return _context5.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction enumerateDevices() {\n  return _regeneratorRuntime().async(function enumerateDevices$(_context6) {\n    while (1) switch (_context6.prev = _context6.next) {\n      case 0:\n        if (!(navigator && navigator.mediaDevices && navigator.mediaDevices.enumerateDevices)) {\n          _context6.next = 4;\n          break;\n        }\n        _context6.next = 3;\n        return _regeneratorRuntime().awrap(navigator.mediaDevices.enumerateDevices());\n      case 3:\n        return _context6.abrupt(\"return\", _context6.sent);\n      case 4:\n        if (!(window.MediaStreamTrack && typeof window.MediaStreamTrack.getSources === 'function')) {\n          _context6.next = 8;\n          break;\n        }\n        _context6.next = 7;\n        return _regeneratorRuntime().awrap(MediaStreamTrack.getSources());\n      case 7:\n        return _context6.abrupt(\"return\", _context6.sent);\n      case 8:\n        return _context6.abrupt(\"return\", null);\n      case 9:\n      case \"end\":\n        return _context6.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction askSensorPermissionAsync() {\n  var requestPermission, status;\n  return _regeneratorRuntime().async(function askSensorPermissionAsync$(_context7) {\n    while (1) switch (_context7.prev = _context7.next) {\n      case 0:\n        requestPermission = getRequestMotionPermission();\n        if (requestPermission) {\n          _context7.next = 3;\n          break;\n        }\n        return _context7.abrupt(\"return\", _Permissions.PermissionStatus.GRANTED);\n      case 3:\n        _context7.next = 5;\n        return _regeneratorRuntime().awrap(requestPermission());\n      case 5:\n        status = _context7.sent;\n        _context7.t0 = status;\n        _context7.next = _context7.t0 === 'granted' ? 9 : _context7.t0 === 'denied' ? 10 : 11;\n        break;\n      case 9:\n        return _context7.abrupt(\"return\", _Permissions.PermissionStatus.GRANTED);\n      case 10:\n        return _context7.abrupt(\"return\", _Permissions.PermissionStatus.DENIED);\n      case 11:\n        return _context7.abrupt(\"return\", _Permissions.PermissionStatus.UNDETERMINED);\n      case 12:\n      case \"end\":\n        return _context7.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction getMediaMaybeGrantedAsync(targetKind) {\n  var devices, result;\n  return _regeneratorRuntime().async(function getMediaMaybeGrantedAsync$(_context8) {\n    while (1) switch (_context8.prev = _context8.next) {\n      case 0:\n        _context8.next = 2;\n        return _regeneratorRuntime().awrap(enumerateDevices());\n      case 2:\n        devices = _context8.sent;\n        if (devices) {\n          _context8.next = 5;\n          break;\n        }\n        return _context8.abrupt(\"return\", false);\n      case 5:\n        _context8.next = 7;\n        return _regeneratorRuntime().awrap(devices.filter(function (_ref3) {\n          var kind = _ref3.kind;\n          return kind === targetKind;\n        }).some(function (_ref4) {\n          var label = _ref4.label;\n          return label !== '';\n        }));\n      case 7:\n        result = _context8.sent;\n        return _context8.abrupt(\"return\", result);\n      case 9:\n      case \"end\":\n        return _context8.stop();\n    }\n  }, null, null, null, Promise);\n}\nfunction getPermissionAsync(permission, shouldAsk) {\n  var status, _window, _window$Notification, Notification, _status, _status2, _status3, maybeStatus, _maybeStatus, maybeGranted, _maybeStatus2, _maybeGranted;\n  return _regeneratorRuntime().async(function getPermissionAsync$(_context9) {\n    while (1) switch (_context9.prev = _context9.next) {\n      case 0:\n        _context9.t0 = permission;\n        _context9.next = _context9.t0 === 'userFacingNotifications' ? 3 : _context9.t0 === 'notifications' ? 3 : _context9.t0 === 'motion' ? 20 : _context9.t0 === 'location' ? 27 : _context9.t0 === 'locationForeground' ? 27 : _context9.t0 === 'locationBackground' ? 27 : _context9.t0 === 'audioRecording' ? 43 : _context9.t0 === 'camera' ? 66 : 89;\n        break;\n      case 3:\n        if (shouldAsk) {\n          _context9.next = 9;\n          break;\n        }\n        _context9.next = 6;\n        return _regeneratorRuntime().awrap(getPermissionWithQueryAsync('notifications'));\n      case 6:\n        status = _context9.sent;\n        if (!status) {\n          _context9.next = 9;\n          break;\n        }\n        return _context9.abrupt(\"return\", {\n          status: status,\n          expires: 'never',\n          granted: status === _Permissions.PermissionStatus.GRANTED,\n          canAskAgain: true\n        });\n      case 9:\n        _window = window, _window$Notification = _window.Notification, Notification = _window$Notification === void 0 ? {} : _window$Notification;\n        if (!Notification.requestPermission) {\n          _context9.next = 19;\n          break;\n        }\n        _status = Notification.permission;\n        if (!shouldAsk) {\n          _context9.next = 16;\n          break;\n        }\n        _context9.next = 15;\n        return _regeneratorRuntime().awrap(Notification.requestPermission());\n      case 15:\n        _status = _context9.sent;\n      case 16:\n        if (!(!_status || _status === 'default')) {\n          _context9.next = 18;\n          break;\n        }\n        return _context9.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.UNDETERMINED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        });\n      case 18:\n        return _context9.abrupt(\"return\", {\n          status: _status,\n          expires: 'never',\n          canAskAgain: true,\n          granted: _status === _Permissions.PermissionStatus.GRANTED\n        });\n      case 19:\n        return _context9.abrupt(\"break\", 90);\n      case 20:\n        if (!shouldAsk) {\n          _context9.next = 25;\n          break;\n        }\n        _context9.next = 23;\n        return _regeneratorRuntime().awrap(askSensorPermissionAsync());\n      case 23:\n        _status2 = _context9.sent;\n        return _context9.abrupt(\"return\", {\n          status: _status2,\n          expires: 'never',\n          granted: _status2 === _Permissions.PermissionStatus.GRANTED,\n          canAskAgain: false\n        });\n      case 25:\n        _status3 = getRequestMotionPermission() ? _Permissions.PermissionStatus.UNDETERMINED : isIOS() ? _Permissions.PermissionStatus.DENIED : _Permissions.PermissionStatus.GRANTED;\n        return _context9.abrupt(\"return\", {\n          status: _status3,\n          expires: 'never',\n          canAskAgain: true,\n          granted: _status3 === _Permissions.PermissionStatus.GRANTED\n        });\n      case 27:\n        _context9.next = 29;\n        return _regeneratorRuntime().awrap(getPermissionWithQueryAsync('geolocation'));\n      case 29:\n        maybeStatus = _context9.sent;\n        if (!maybeStatus) {\n          _context9.next = 38;\n          break;\n        }\n        if (!(maybeStatus === _Permissions.PermissionStatus.UNDETERMINED && shouldAsk)) {\n          _context9.next = 35;\n          break;\n        }\n        _context9.next = 34;\n        return _regeneratorRuntime().awrap(askForLocationPermissionAsync());\n      case 34:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 35:\n        return _context9.abrupt(\"return\", {\n          status: maybeStatus,\n          expires: 'never',\n          canAskAgain: true,\n          granted: maybeStatus === _Permissions.PermissionStatus.GRANTED\n        });\n      case 38:\n        if (!shouldAsk) {\n          _context9.next = 42;\n          break;\n        }\n        _context9.next = 41;\n        return _regeneratorRuntime().awrap(askForLocationPermissionAsync());\n      case 41:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 42:\n        return _context9.abrupt(\"break\", 90);\n      case 43:\n        _context9.next = 45;\n        return _regeneratorRuntime().awrap(getPermissionWithQueryAsync('microphone'));\n      case 45:\n        _maybeStatus = _context9.sent;\n        if (!_maybeStatus) {\n          _context9.next = 54;\n          break;\n        }\n        if (!(_maybeStatus === _Permissions.PermissionStatus.UNDETERMINED && shouldAsk)) {\n          _context9.next = 51;\n          break;\n        }\n        _context9.next = 50;\n        return _regeneratorRuntime().awrap(askForMicrophonePermissionAsync());\n      case 50:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 51:\n        return _context9.abrupt(\"return\", {\n          status: _maybeStatus,\n          expires: 'never',\n          canAskAgain: true,\n          granted: _maybeStatus === _Permissions.PermissionStatus.GRANTED\n        });\n      case 54:\n        if (!shouldAsk) {\n          _context9.next = 60;\n          break;\n        }\n        _context9.next = 57;\n        return _regeneratorRuntime().awrap(askForMicrophonePermissionAsync());\n      case 57:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 60:\n        _context9.next = 62;\n        return _regeneratorRuntime().awrap(getMediaMaybeGrantedAsync('audioinput'));\n      case 62:\n        maybeGranted = _context9.sent;\n        if (!maybeGranted) {\n          _context9.next = 65;\n          break;\n        }\n        return _context9.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.GRANTED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: true\n        });\n      case 65:\n        return _context9.abrupt(\"break\", 90);\n      case 66:\n        _context9.next = 68;\n        return _regeneratorRuntime().awrap(getPermissionWithQueryAsync('camera'));\n      case 68:\n        _maybeStatus2 = _context9.sent;\n        if (!_maybeStatus2) {\n          _context9.next = 77;\n          break;\n        }\n        if (!(_maybeStatus2 === _Permissions.PermissionStatus.UNDETERMINED && shouldAsk)) {\n          _context9.next = 74;\n          break;\n        }\n        _context9.next = 73;\n        return _regeneratorRuntime().awrap(askForCameraPermissionAsync());\n      case 73:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 74:\n        return _context9.abrupt(\"return\", {\n          status: _maybeStatus2,\n          expires: 'never',\n          canAskAgain: true,\n          granted: _maybeStatus2 === _Permissions.PermissionStatus.GRANTED\n        });\n      case 77:\n        if (!shouldAsk) {\n          _context9.next = 83;\n          break;\n        }\n        _context9.next = 80;\n        return _regeneratorRuntime().awrap(askForCameraPermissionAsync());\n      case 80:\n        return _context9.abrupt(\"return\", _context9.sent);\n      case 83:\n        _context9.next = 85;\n        return _regeneratorRuntime().awrap(getMediaMaybeGrantedAsync('videoinput'));\n      case 85:\n        _maybeGranted = _context9.sent;\n        if (!_maybeGranted) {\n          _context9.next = 88;\n          break;\n        }\n        return _context9.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.GRANTED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: true\n        });\n      case 88:\n        return _context9.abrupt(\"break\", 90);\n      case 89:\n        return _context9.abrupt(\"break\", 90);\n      case 90:\n        return _context9.abrupt(\"return\", {\n          status: _Permissions.PermissionStatus.UNDETERMINED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        });\n      case 91:\n      case \"end\":\n        return _context9.stop();\n    }\n  }, null, null, null, Promise);\n}\nvar _default = {\n  get name() {\n    return 'ExpoPermissions';\n  },\n  getAsync: function getAsync(permissionTypes) {\n    var results, _iterator, _step, permissionType;\n    return _regeneratorRuntime().async(function getAsync$(_context10) {\n      while (1) switch (_context10.prev = _context10.next) {\n        case 0:\n          results = {};\n          _iterator = _createForOfIteratorHelperLoose(new Set(permissionTypes));\n        case 2:\n          if ((_step = _iterator()).done) {\n            _context10.next = 9;\n            break;\n          }\n          permissionType = _step.value;\n          _context10.next = 6;\n          return _regeneratorRuntime().awrap(getPermissionAsync(permissionType, false));\n        case 6:\n          results[permissionType] = _context10.sent;\n        case 7:\n          _context10.next = 2;\n          break;\n        case 9:\n          return _context10.abrupt(\"return\", results);\n        case 10:\n        case \"end\":\n          return _context10.stop();\n      }\n    }, null, null, null, Promise);\n  },\n  askAsync: function askAsync(permissionTypes) {\n    var results, _iterator2, _step2, permissionType;\n    return _regeneratorRuntime().async(function askAsync$(_context11) {\n      while (1) switch (_context11.prev = _context11.next) {\n        case 0:\n          results = {};\n          _iterator2 = _createForOfIteratorHelperLoose(new Set(permissionTypes));\n        case 2:\n          if ((_step2 = _iterator2()).done) {\n            _context11.next = 9;\n            break;\n          }\n          permissionType = _step2.value;\n          _context11.next = 6;\n          return _regeneratorRuntime().awrap(getPermissionAsync(permissionType, true));\n        case 6:\n          results[permissionType] = _context11.sent;\n        case 7:\n          _context11.next = 2;\n          break;\n        case 9:\n          return _context11.abrupt(\"return\", results);\n        case 10:\n        case \"end\":\n          return _context11.stop();\n      }\n    }, null, null, null, Promise);\n  }\n};\nexports.default = _default;\nfunction getRequestMotionPermission() {\n  var _DeviceMotionEvent;\n  if (typeof DeviceMotionEvent !== 'undefined' && !!((_DeviceMotionEvent = DeviceMotionEvent) != null && _DeviceMotionEvent.requestPermission)) {\n    return DeviceMotionEvent.requestPermission;\n  }\n  return null;\n}\nfunction isIOS() {\n  var isIOSUA = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n  var isIE11 = !!window['MSStream'];\n  return isIOSUA && !isIE11;\n}","map":{"version":3,"sources":["../src/ExpoPermissions.web.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  PermissionMap,\n  PermissionType,\n  PermissionStatus,\n  PermissionInfo,\n} from './Permissions.types';\n\n/*\n * TODO: Bacon: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Permissions\n * Add messages to manifest like we do with iOS info.plist\n */\n\n// https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Using_the_new_API_in_older_browsers\n// Older browsers might not implement mediaDevices at all, so we set an empty object first\nfunction _getUserMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n\n  // First get ahold of the legacy getUserMedia, if present\n  const getUserMedia =\n    // TODO: this method is deprecated, migrate to https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    navigator.getUserMedia ||\n    navigator.webkitGetUserMedia ||\n    navigator.mozGetUserMedia ||\n    function () {\n      const error: any = new Error('Permission unimplemented');\n      error.code = 0;\n      error.name = 'NotAllowedError';\n      throw error;\n    };\n\n  return new Promise((resolve, reject) => {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\n\nasync function askForMediaPermissionAsync(\n  options: MediaStreamConstraints\n): Promise<PermissionInfo> {\n  try {\n    await _getUserMedia(options);\n    return {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: true,\n    };\n  } catch ({ message }) {\n    // name: NotAllowedError\n    // code: 0\n    if (message === 'Permission dismissed') {\n      // message: Permission dismissed\n      return {\n        status: PermissionStatus.UNDETERMINED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n    } else {\n      // TODO: Bacon: [OSX] The system could deny access to chrome.\n      // TODO: Bacon: add: { status: 'unimplemented' }\n      // message: Permission denied\n      return {\n        status: PermissionStatus.DENIED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n    }\n  }\n}\n\nasync function askForMicrophonePermissionAsync(): Promise<PermissionInfo> {\n  return await askForMediaPermissionAsync({ audio: true });\n}\n\nasync function askForCameraPermissionAsync(): Promise<PermissionInfo> {\n  return await askForMediaPermissionAsync({ video: true });\n}\n\nasync function askForLocationPermissionAsync(): Promise<PermissionInfo> {\n  return new Promise((resolve) => {\n    navigator.geolocation.getCurrentPosition(\n      () =>\n        resolve({\n          status: PermissionStatus.GRANTED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: true,\n        }),\n      ({ code }: GeolocationPositionError) => {\n        // https://developer.mozilla.org/en-US/docs/Web/API/PositionError/code\n        if (code === 1) {\n          resolve({\n            status: PermissionStatus.DENIED,\n            expires: 'never',\n            canAskAgain: true,\n            granted: false,\n          });\n        } else {\n          resolve({\n            status: PermissionStatus.UNDETERMINED,\n            expires: 'never',\n            canAskAgain: true,\n            granted: false,\n          });\n        }\n      }\n    );\n  });\n}\n\nasync function getPermissionWithQueryAsync(\n  name: PermissionNameWithAdditionalValues\n): Promise<PermissionStatus | null> {\n  if (!navigator || !navigator.permissions || !navigator.permissions.query) return null;\n\n  const { state } = await navigator.permissions.query({ name });\n  if (state === 'prompt') {\n    return PermissionStatus.UNDETERMINED;\n  } else if (state === 'granted') {\n    return PermissionStatus.GRANTED;\n  } else if (state === 'denied') {\n    return PermissionStatus.DENIED;\n  }\n  return null;\n}\n\nasync function enumerateDevices(): Promise<MediaDeviceInfo[] | null> {\n  if (navigator && navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n    return await navigator.mediaDevices.enumerateDevices();\n  }\n\n  // @ts-ignore: This is deprecated but we should still attempt to use it.\n  if (window.MediaStreamTrack && typeof window.MediaStreamTrack.getSources === 'function') {\n    // @ts-ignore\n    return await MediaStreamTrack.getSources();\n  }\n  return null;\n}\n\nasync function askSensorPermissionAsync(): Promise<PermissionStatus> {\n  const requestPermission = getRequestMotionPermission();\n  // Technically this is incorrect because it doesn't account for iOS 12.2 Safari.\n  // But unfortunately we can only abstract so much.\n  if (!requestPermission) return PermissionStatus.GRANTED;\n\n  // If this isn't invoked in a touch-event then it never resolves.\n  // Safari probably should throw an error but because it doesn't we have no way of informing the developer.\n  const status = await requestPermission();\n  switch (status) {\n    case 'granted':\n      return PermissionStatus.GRANTED;\n    case 'denied':\n      return PermissionStatus.DENIED;\n    default:\n      return PermissionStatus.UNDETERMINED;\n  }\n}\n\nasync function getMediaMaybeGrantedAsync(targetKind: MediaDeviceKind): Promise<boolean> {\n  const devices = await enumerateDevices();\n  if (!devices) {\n    return false;\n  }\n  const result = await devices\n    .filter(({ kind }) => kind === targetKind)\n    .some(({ label }) => label !== '');\n  // Granted or denied or undetermined or no devices\n  return result;\n}\n\nasync function getPermissionAsync(\n  permission: PermissionType,\n  shouldAsk: boolean\n): Promise<PermissionInfo> {\n  switch (permission) {\n    case 'userFacingNotifications':\n    case 'notifications':\n      {\n        if (!shouldAsk) {\n          const status = await getPermissionWithQueryAsync('notifications');\n          if (status) {\n            return {\n              status,\n              expires: 'never',\n              granted: status === PermissionStatus.GRANTED,\n              canAskAgain: true,\n            };\n          }\n        }\n\n        const { Notification = {} } = window as any;\n        if (Notification.requestPermission) {\n          let status = Notification.permission;\n          if (shouldAsk) {\n            status = await Notification.requestPermission();\n          }\n          if (!status || status === 'default') {\n            return {\n              status: PermissionStatus.UNDETERMINED,\n              expires: 'never',\n              canAskAgain: true,\n              granted: false,\n            };\n          }\n          return {\n            status,\n            expires: 'never',\n            canAskAgain: true,\n            granted: status === PermissionStatus.GRANTED,\n          };\n        }\n      }\n      break;\n    case 'motion': {\n      if (shouldAsk) {\n        const status = await askSensorPermissionAsync();\n        return {\n          status,\n          expires: 'never',\n          granted: status === PermissionStatus.GRANTED,\n          canAskAgain: false,\n        };\n      }\n\n      // We can infer from the requestor if this is an older browser.\n      const status = getRequestMotionPermission()\n        ? PermissionStatus.UNDETERMINED\n        : isIOS()\n        ? PermissionStatus.DENIED\n        : PermissionStatus.GRANTED;\n      return {\n        status,\n        expires: 'never',\n        canAskAgain: true,\n        granted: status === PermissionStatus.GRANTED,\n      };\n    }\n    case 'location':\n    case 'locationForeground':\n    case 'locationBackground':\n      {\n        const maybeStatus = await getPermissionWithQueryAsync('geolocation');\n        if (maybeStatus) {\n          if (maybeStatus === PermissionStatus.UNDETERMINED && shouldAsk) {\n            return await askForLocationPermissionAsync();\n          }\n          return {\n            status: maybeStatus,\n            expires: 'never',\n            canAskAgain: true,\n            granted: maybeStatus === PermissionStatus.GRANTED,\n          };\n        } else if (shouldAsk) {\n          // TODO: Bacon: should this function as ask async when not in chrome?\n          return await askForLocationPermissionAsync();\n        }\n      }\n      break;\n    case 'audioRecording':\n      {\n        const maybeStatus = await getPermissionWithQueryAsync('microphone');\n        if (maybeStatus) {\n          if (maybeStatus === PermissionStatus.UNDETERMINED && shouldAsk) {\n            return await askForMicrophonePermissionAsync();\n          }\n          return {\n            status: maybeStatus,\n            expires: 'never',\n            canAskAgain: true,\n            granted: maybeStatus === PermissionStatus.GRANTED,\n          };\n        } else if (shouldAsk) {\n          return await askForMicrophonePermissionAsync();\n        } else {\n          const maybeGranted = await getMediaMaybeGrantedAsync('audioinput');\n          if (maybeGranted) {\n            return {\n              status: PermissionStatus.GRANTED,\n              expires: 'never',\n              canAskAgain: true,\n              granted: true,\n            };\n          }\n          // TODO: Bacon: Get denied or undetermined...\n        }\n      }\n      break;\n    case 'camera':\n      {\n        const maybeStatus = await getPermissionWithQueryAsync('camera');\n        if (maybeStatus) {\n          if (maybeStatus === PermissionStatus.UNDETERMINED && shouldAsk) {\n            return await askForCameraPermissionAsync();\n          }\n          return {\n            status: maybeStatus,\n            expires: 'never',\n            canAskAgain: true,\n            granted: maybeStatus === PermissionStatus.GRANTED,\n          };\n        } else if (shouldAsk) {\n          return await askForCameraPermissionAsync();\n        } else {\n          const maybeGranted = await getMediaMaybeGrantedAsync('videoinput');\n          if (maybeGranted) {\n            return {\n              status: PermissionStatus.GRANTED,\n              expires: 'never',\n              canAskAgain: true,\n              granted: true,\n            };\n          }\n          // TODO: Bacon: Get denied or undetermined...\n        }\n      }\n      break;\n    default:\n      break;\n  }\n  return {\n    status: PermissionStatus.UNDETERMINED,\n    expires: 'never',\n    canAskAgain: true,\n    granted: false,\n  };\n}\n\nexport default {\n  get name(): string {\n    return 'ExpoPermissions';\n  },\n\n  async getAsync(permissionTypes: PermissionType[]): Promise<PermissionMap> {\n    const results = {};\n    for (const permissionType of new Set(permissionTypes)) {\n      results[permissionType] = await getPermissionAsync(permissionType, /* shouldAsk */ false);\n    }\n    return results;\n  },\n\n  async askAsync(permissionTypes: PermissionType[]): Promise<PermissionMap> {\n    const results = {};\n    for (const permissionType of new Set(permissionTypes)) {\n      results[permissionType] = await getPermissionAsync(permissionType, /* shouldAsk */ true);\n    }\n    return results;\n  },\n};\n\n/**\n * Temporary solution until `tslib.d.ts` is updated to include the new DeviceMotion API.\n * `typescript@4.4.4` is missing `requestPermission` described in https://w3c.github.io/deviceorientation/#devicemotion\n * MDN docs do not describe this property as well https://developer.mozilla.org/en-US/docs/Web/API/DeviceMotionEvent\n */\ndeclare let DeviceMotionEvent: {\n  prototype: DeviceMotionEvent;\n  new (type: string, eventInitDict?: DeviceMotionEventInit): DeviceMotionEvent;\n  requestPermission?: () => Promise<PermissionState>;\n};\n\nexport function getRequestMotionPermission(): (() => Promise<PermissionState>) | null {\n  if (typeof DeviceMotionEvent !== 'undefined' && !!DeviceMotionEvent?.requestPermission) {\n    return DeviceMotionEvent.requestPermission;\n  }\n\n  return null;\n}\n\n// https://stackoverflow.com/a/9039885/4047926\nfunction isIOS(): boolean {\n  const isIOSUA = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n  const isIE11 = !!window['MSStream'];\n  return isIOSUA && !isIE11;\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}