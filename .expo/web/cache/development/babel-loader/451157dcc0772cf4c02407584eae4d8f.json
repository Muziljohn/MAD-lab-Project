{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\nvar React = _interopRequireWildcard(require(\"react\"));\nvar _reactNative = require(\"react-native\");\nvar _native = require(\"@react-navigation/native\");\nvar _reactNativeScreens = require(\"react-native-screens\");\nvar _SafeAreaProviderCompat = _interopRequireDefault(require(\"./SafeAreaProviderCompat\"));\nvar _ResourceSavingScene = _interopRequireDefault(require(\"./ResourceSavingScene\"));\nvar _BottomTabBar = _interopRequireDefault(require(\"./BottomTabBar\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction SceneContent(_ref) {\n  var isFocused = _ref.isFocused,\n    children = _ref.children;\n  var _useTheme = (0, _native.useTheme)(),\n    colors = _useTheme.colors;\n  return React.createElement(_reactNative.View, {\n    accessibilityElementsHidden: !isFocused,\n    importantForAccessibility: isFocused ? 'auto' : 'no-hide-descendants',\n    style: [styles.content, {\n      backgroundColor: colors.background\n    }]\n  }, children);\n}\nvar BottomTabView = function (_React$Component) {\n  (0, _inherits2.default)(BottomTabView, _React$Component);\n  var _super = _createSuper(BottomTabView);\n  function BottomTabView() {\n    var _this;\n    (0, _classCallCheck2.default)(this, BottomTabView);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty((0, _assertThisInitialized2.default)(_this), \"state\", {\n      loaded: [_this.props.state.index]\n    });\n    _defineProperty((0, _assertThisInitialized2.default)(_this), \"renderTabBar\", function () {\n      var _this$props = _this.props,\n        _this$props$tabBar = _this$props.tabBar,\n        tabBar = _this$props$tabBar === void 0 ? function (props) {\n          return React.createElement(_BottomTabBar.default, props);\n        } : _this$props$tabBar,\n        tabBarOptions = _this$props.tabBarOptions,\n        state = _this$props.state,\n        navigation = _this$props.navigation;\n      var descriptors = _this.props.descriptors;\n      var route = state.routes[state.index];\n      var descriptor = descriptors[route.key];\n      var options = descriptor.options;\n      if (options.tabBarVisible === false) {\n        return null;\n      }\n      return tabBar(_objectSpread(_objectSpread({}, tabBarOptions), {}, {\n        state: state,\n        descriptors: descriptors,\n        navigation: navigation\n      }));\n    });\n    return _this;\n  }\n  (0, _createClass2.default)(BottomTabView, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n        state = _this$props2.state,\n        descriptors = _this$props2.descriptors,\n        navigation = _this$props2.navigation,\n        lazy = _this$props2.lazy;\n      var routes = state.routes;\n      var loaded = this.state.loaded;\n      return React.createElement(_native.NavigationHelpersContext.Provider, {\n        value: navigation\n      }, React.createElement(_SafeAreaProviderCompat.default, null, React.createElement(_reactNative.View, {\n        style: styles.container\n      }, React.createElement(_reactNativeScreens.ScreenContainer, {\n        style: styles.pages\n      }, routes.map(function (route, index) {\n        var descriptor = descriptors[route.key];\n        var unmountOnBlur = descriptor.options.unmountOnBlur;\n        var isFocused = state.index === index;\n        if (unmountOnBlur && !isFocused) {\n          return null;\n        }\n        if (lazy && !loaded.includes(index) && !isFocused) {\n          return null;\n        }\n        return React.createElement(_ResourceSavingScene.default, {\n          key: route.key,\n          style: _reactNative.StyleSheet.absoluteFill,\n          isVisible: isFocused\n        }, React.createElement(SceneContent, {\n          isFocused: isFocused\n        }, descriptor.render()));\n      })), this.renderTabBar())));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var index = nextProps.state.index;\n      return {\n        loaded: prevState.loaded.includes(index) ? prevState.loaded : [].concat((0, _toConsumableArray2.default)(prevState.loaded), [index])\n      };\n    }\n  }]);\n  return BottomTabView;\n}(React.Component);\nexports.default = BottomTabView;\n_defineProperty(BottomTabView, \"defaultProps\", {\n  lazy: true\n});\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden'\n  },\n  pages: {\n    flex: 1\n  },\n  content: {\n    flex: 1\n  }\n});","map":{"version":3,"sources":["BottomTabView.tsx"],"names":["SceneContent","isFocused","children","colors","useTheme","styles","content","backgroundColor","background","BottomTabView","React","Component","lazy","nextProps","prevState","index","state","loaded","includes","props","tabBar","tabBarOptions","navigation","descriptors","route","routes","descriptor","key","options","tabBarVisible","render","container","pages","map","unmountOnBlur","StyleSheet","absoluteFill","renderTabBar","create","flex","overflow"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { View, StyleSheet } from 'react-native';\n\nimport {\n  NavigationHelpersContext,\n  TabNavigationState,\n  useTheme,\n} from '@react-navigation/native';\n// eslint-disable-next-line import/no-unresolved\nimport { ScreenContainer } from 'react-native-screens';\n\nimport SafeAreaProviderCompat from './SafeAreaProviderCompat';\nimport ResourceSavingScene from './ResourceSavingScene';\nimport BottomTabBar from './BottomTabBar';\nimport {\n  BottomTabNavigationConfig,\n  BottomTabDescriptorMap,\n  BottomTabNavigationHelpers,\n  BottomTabBarProps,\n} from '../types';\n\ntype Props = BottomTabNavigationConfig & {\n  state: TabNavigationState;\n  navigation: BottomTabNavigationHelpers;\n  descriptors: BottomTabDescriptorMap;\n};\n\ntype State = {\n  loaded: number[];\n};\n\nfunction SceneContent({\n  isFocused,\n  children,\n}: {\n  isFocused: boolean;\n  children: React.ReactNode;\n}) {\n  const { colors } = useTheme();\n\n  return (\n    <View\n      accessibilityElementsHidden={!isFocused}\n      importantForAccessibility={isFocused ? 'auto' : 'no-hide-descendants'}\n      style={[styles.content, { backgroundColor: colors.background }]}\n    >\n      {children}\n    </View>\n  );\n}\n\nexport default class BottomTabView extends React.Component<Props, State> {\n  static defaultProps = {\n    lazy: true,\n  };\n\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n    const { index } = nextProps.state;\n\n    return {\n      // Set the current tab to be loaded if it was not loaded before\n      loaded: prevState.loaded.includes(index)\n        ? prevState.loaded\n        : [...prevState.loaded, index],\n    };\n  }\n\n  state = {\n    loaded: [this.props.state.index],\n  };\n\n  private renderTabBar = () => {\n    const {\n      tabBar = (props: BottomTabBarProps) => <BottomTabBar {...props} />,\n      tabBarOptions,\n      state,\n      navigation,\n    } = this.props;\n\n    const { descriptors } = this.props;\n    const route = state.routes[state.index];\n    const descriptor = descriptors[route.key];\n    const options = descriptor.options;\n\n    if (options.tabBarVisible === false) {\n      return null;\n    }\n\n    return tabBar({\n      ...tabBarOptions,\n      state: state,\n      descriptors: descriptors,\n      navigation: navigation,\n    });\n  };\n\n  render() {\n    const { state, descriptors, navigation, lazy } = this.props;\n    const { routes } = state;\n    const { loaded } = this.state;\n\n    return (\n      <NavigationHelpersContext.Provider value={navigation}>\n        <SafeAreaProviderCompat>\n          <View style={styles.container}>\n            <ScreenContainer style={styles.pages}>\n              {routes.map((route, index) => {\n                const descriptor = descriptors[route.key];\n                const { unmountOnBlur } = descriptor.options;\n                const isFocused = state.index === index;\n\n                if (unmountOnBlur && !isFocused) {\n                  return null;\n                }\n\n                if (lazy && !loaded.includes(index) && !isFocused) {\n                  // Don't render a screen if we've never navigated to it\n                  return null;\n                }\n\n                return (\n                  <ResourceSavingScene\n                    key={route.key}\n                    style={StyleSheet.absoluteFill}\n                    isVisible={isFocused}\n                  >\n                    <SceneContent isFocused={isFocused}>\n                      {descriptor.render()}\n                    </SceneContent>\n                  </ResourceSavingScene>\n                );\n              })}\n            </ScreenContainer>\n            {this.renderTabBar()}\n          </View>\n        </SafeAreaProviderCompat>\n      </NavigationHelpersContext.Provider>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden',\n  },\n  pages: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n  },\n});\n"]},"metadata":{},"sourceType":"script"}